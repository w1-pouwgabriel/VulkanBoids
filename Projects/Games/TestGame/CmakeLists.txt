# Add executable
set(PROJECT_NAME1 "TestGame")

add_executable(${PROJECT_NAME1})

# Find all subdirectories in the GAMES_DIRECTORY
file(GLOB SUBDIRS "${CMAKE_CURRENT_LIST_DIR}/Source/*.cpp")
foreach(SUBDIR ${SUBDIRS})
    if(IS_DIRECTORY ${SUBDIR})
        # Add each subdirectory as a subdirectory of the main project
        add_subdirectory(${SUBDIR})
    endif()
endforeach()

# Sources
file(GLOB SOURCES_PRIVATE "${CMAKE_CURRENT_LIST_DIR}/Source/*.cpp")
file(GLOB HEADERS_PUBLIC "${CMAKE_CURRENT_LIST_DIR}/Source/*.h")

# Add sources to target
target_sources(${PROJECT_NAME1} PRIVATE ${SOURCES_PRIVATE})
target_sources(${PROJECT_NAME1} PUBLIC ${HEADERS_PUBLIC})

# Private includes
target_include_directories(${PROJECT_NAME1} PUBLIC ${Vulkan_INCLUDE_DIRS})
target_include_directories(${PROJECT_NAME1} PUBLIC ${SOURCE_RUNTIME_DIRECTORY}/Graphics)
target_include_directories(${PROJECT_NAME1} PUBLIC ${SOURCE_RUNTIME_DIRECTORY}/Core)
target_include_directories(${PROJECT_NAME1} PUBLIC ${SOURCE_RUNTIME_DIRECTORY}/Engine)

# Link libraries
target_link_libraries(${PROJECT_NAME1} PUBLIC Graphics)
target_link_libraries(${PROJECT_NAME1} PUBLIC Core)
target_link_libraries(${PROJECT_NAME1} PUBLIC Engine)

# Compile definitions
target_compile_definitions(Graphics PUBLIC -DRTS_VULKAN)

# Ensure we are building a console application, not a Windows GUI application
if (WIN32)
    set_target_properties(${PROJECT_NAME1} PROPERTIES LINK_FLAGS "/SUBSYSTEM:CONSOLE")
endif()